        -:    0:Source:/home/workspace/lib/settings.h
        -:    0:Graph:/home/workspace/build/lib/CMakeFiles/lib_objs.dir/tokenize.gcno
        -:    0:Data:/home/workspace/build/lib/CMakeFiles/lib_objs.dir/tokenize.gcda
        -:    0:Runs:1
        -:    0:Programs:1
        -:    1:/*
        -:    2: * Cppcheck - A tool for static C/C++ code analysis
        -:    3: * Copyright (C) 2007-2019 Cppcheck team.
        -:    4: *
        -:    5: * This program is free software: you can redistribute it and/or modify
        -:    6: * it under the terms of the GNU General Public License as published by
        -:    7: * the Free Software Foundation, either version 3 of the License, or
        -:    8: * (at your option) any later version.
        -:    9: *
        -:   10: * This program is distributed in the hope that it will be useful,
        -:   11: * but WITHOUT ANY WARRANTY; without even the implied warranty of
        -:   12: * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
        -:   13: * GNU General Public License for more details.
        -:   14: *
        -:   15: * You should have received a copy of the GNU General Public License
        -:   16: * along with this program.  If not, see <http://www.gnu.org/licenses/>.
        -:   17: */
        -:   18:
        -:   19://---------------------------------------------------------------------------
        -:   20:#ifndef settingsH
        -:   21:#define settingsH
        -:   22://---------------------------------------------------------------------------
        -:   23:
        -:   24:#include "config.h"
        -:   25:#include "errorlogger.h"
        -:   26:#include "importproject.h"
        -:   27:#include "library.h"
        -:   28:#include "platform.h"
        -:   29:#include "standards.h"
        -:   30:#include "suppressions.h"
        -:   31:#include "timer.h"
        -:   32:
        -:   33:#include <list>
        -:   34:#include <set>
        -:   35:#include <string>
        -:   36:#include <vector>
        -:   37:
        -:   38:namespace ValueFlow {
        -:   39:    class Value;
        -:   40:}
        -:   41:
        -:   42:/// @addtogroup Core
        -:   43:/// @{
        -:   44:
        -:   45:/**
        -:   46: * @brief This is just a container for general settings so that we don't need
        -:   47: * to pass individual values to functions or constructors now or in the
        -:   48: * future when we might have even more detailed settings.
        -:   49: */
        -:   50:class CPPCHECKLIB Settings : public cppcheck::Platform {
        -:   51:public:
        -:   52:    enum EnabledGroup {
        -:   53:        WARNING = 0x1,
        -:   54:        STYLE = 0x2,
        -:   55:        PERFORMANCE = 0x4,
        -:   56:        PORTABILITY = 0x8,
        -:   57:        INFORMATION = 0x10,
        -:   58:        UNUSED_FUNCTION = 0x20,
        -:   59:        MISSING_INCLUDE = 0x40,
        -:   60:        INTERNAL = 0x80
        -:   61:    };
        -:   62:
        -:   63:private:
        -:   64:    /** @brief enable extra checks by id */
        -:   65:    int mEnabled;
        -:   66:
        -:   67:    /** @brief terminate checking */
        -:   68:    static bool mTerminated;
        -:   69:
        -:   70:public:
        -:   71:    Settings();
        -:   72:
        -:   73:    std::list<std::string> addons;
        -:   74:
        -:   75:    /** @brief Paths used as base for conversion to relative paths. */
        -:   76:    std::vector<std::string> basePaths;
        -:   77:
        -:   78:    /** @brief --cppcheck-build-dir */
        -:   79:    std::string buildDir;
        -:   80:
        -:   81:    /** Is the 'configuration checking' wanted? */
        -:   82:    bool checkConfiguration;
        -:   83:
        -:   84:    /** Check for incomplete info in library files? */
        -:   85:    bool checkLibrary;
        -:   86:
        -:   87:    /**
        -:   88:     * Check code in the headers, this is on by default but can
        -:   89:     * be turned off to save CPU */
        -:   90:    bool checkHeaders;
        -:   91:
        -:   92:    /** Check unused templates */
        -:   93:    bool checkUnusedTemplates;
        -:   94:
        -:   95:    /** @brief include paths excluded from checking the configuration */
        -:   96:    std::set<std::string> configExcludePaths;
        -:   97:
        -:   98:    /** @brief Is --debug-simplified given? */
        -:   99:    bool debugSimplified;
        -:  100:
        -:  101:    /** @brief Is --debug-normal given? */
        -:  102:    bool debugnormal;
        -:  103:
        -:  104:    /** @brief Is --debug-warnings given? */
        -:  105:    bool debugwarnings;
        -:  106:
        -:  107:    /** @brief Is --debug-template given? */
        -:  108:    bool debugtemplate;
        -:  109:
        -:  110:    /** @brief Is --dump given? */
        -:  111:    bool dump;
        -:  112:    std::string dumpFile;
        -:  113:
        -:  114:    enum Language {
        -:  115:        None, C, CPP
        -:  116:    };
        -:  117:
        -:  118:    /** @brief Name of the language that is enforced. Empty per default. */
        -:  119:    Language enforcedLang;
        -:  120:
        -:  121:    /** @brief Is --exception-handling given */
        -:  122:    bool exceptionHandling;
        -:  123:
        -:  124:    // argv[0]
        -:  125:    std::string exename;
        -:  126:
        -:  127:    /** @brief If errors are found, this value is returned from main().
        -:  128:        Default value is 0. */
        -:  129:    int exitCode;
        -:  130:
        -:  131:    /**
        -:  132:     * When this flag is false (default) then experimental
        -:  133:     * heuristics and checks are disabled.
        -:  134:     *
        -:  135:     * It should not be possible to enable this from any client.
        -:  136:     */
        -:  137:    bool experimental;
        -:  138:
        -:  139:    /** @brief Force checking the files with "too many" configurations (--force). */
        -:  140:    bool force;
        -:  141:
        -:  142:    /** @brief List of include paths, e.g. "my/includes/" which should be used
        -:  143:        for finding include files inside source files. (-I) */
        -:  144:    std::list<std::string> includePaths;
        -:  145:
        -:  146:    /** @brief Inconclusive checks */
        -:  147:    bool inconclusive;
        -:  148:
        -:  149:    /** Do not only check how interface is used. Also check that interface is safe. */
        -:  150:    class CPPCHECKLIB SafeChecks {
        -:  151:    public:
        -:  152:        SafeChecks() : classes(false), externalFunctions(false), internalFunctions(false), externalVariables(false) {}
        -:  153:
        -:  154:        static const char XmlRootName[];
        -:  155:        static const char XmlClasses[];
        -:  156:        static const char XmlExternalFunctions[];
        -:  157:        static const char XmlInternalFunctions[];
        -:  158:        static const char XmlExternalVariables[];
        -:  159:
        -:  160:        /**
        -:  161:         * Public interface of classes
        -:  162:         * - public function parameters can have any value
        -:  163:         * - public functions can be called in any order
        -:  164:         * - public variables can have any value
        -:  165:         */
        -:  166:        bool classes;
        -:  167:
        -:  168:        /**
        -:  169:         * External functions
        -:  170:         * - external functions can be called in any order
        -:  171:         * - function parameters can have any values
        -:  172:         */
        -:  173:        bool externalFunctions;
        -:  174:
        -:  175:        /**
        -:  176:         * Experimental: assume that internal functions can be used in any way
        -:  177:         * This is only available in the GUI.
        -:  178:         */
        -:  179:        bool internalFunctions;
        -:  180:
        -:  181:        /**
        -:  182:         * Global variables that can be modified outside the TU.
        -:  183:         * - Such variable can have "any" value
        -:  184:         */
        -:  185:        bool externalVariables;
        -:  186:    };
        -:  187:
        -:  188:    SafeChecks safeChecks;
        -:  189:
        -:  190:    /** @brief Enable verification analysis */
        -:  191:    bool verification;
        -:  192:
        -:  193:    bool debugVerification;
        -:  194:
        -:  195:    /** @brief check unknown function return values */
        -:  196:    std::set<std::string> checkUnknownFunctionReturn;
        -:  197:
        -:  198:    /** @brief Is --inline-suppr given? */
        -:  199:    bool inlineSuppressions;
        -:  200:
        -:  201:    /** @brief How many processes/threads should do checking at the same
        -:  202:        time. Default is 1. (-j N) */
        -:  203:    unsigned int jobs;
        -:  204:
        -:  205:    /** @brief Collect unmatched suppressions in one run.
        -:  206:      * This delays the reporting until all files are checked.
        -:  207:      * It is needed by checks that analyse the whole code base. */
        -:  208:    bool jointSuppressionReport;
        -:  209:
        -:  210:    /** @brief --library= */
        -:  211:    std::list<std::string> libraries;
        -:  212:
        -:  213:    /** Library */
        -:  214:    Library library;
        -:  215:
        -:  216:    /** @brief Load average value */
        -:  217:    unsigned int loadAverage;
        -:  218:
        -:  219:    /** @brief Maximum number of configurations to check before bailing.
        -:  220:        Default is 12. (--max-configs=N) */
        -:  221:    unsigned int maxConfigs;
        -:  222:
        -:  223:    /** @brief --max-ctu-depth */
        -:  224:    int maxCtuDepth;
        -:  225:
        -:  226:    /** @brief suppress exitcode */
        -:  227:    Suppressions nofail;
        -:  228:
        -:  229:    /** @brief suppress message (--suppressions) */
        -:  230:    Suppressions nomsg;
        -:  231:
        -:  232:    /** @brief write results (--output-file=&lt;file&gt;) */
        -:  233:    std::string outputFile;
        -:  234:
        -:  235:    /** @brief plist output (--plist-output=&lt;dir&gt;) */
        -:  236:    std::string plistOutput;
        -:  237:
        -:  238:    /** @brief Using -E for debugging purposes */
        -:  239:    bool preprocessOnly;
        -:  240:
        -:  241:    ImportProject project;
        -:  242:
        -:  243:    /** @brief Is --quiet given? */
        -:  244:    bool quiet;
        -:  245:
        -:  246:    /** @brief Use relative paths in output. */
        -:  247:    bool relativePaths;
        -:  248:
        -:  249:    /** @brief --report-progress */
        -:  250:    bool reportProgress;
        -:  251:
        -:  252:    /** Rule */
        -:  253:    class CPPCHECKLIB Rule {
        -:  254:    public:
        -:  255:        Rule()
        -:  256:            : tokenlist("simple")         // use simple tokenlist
        -:  257:            , id("rule")                  // default id
        -:  258:            , severity(Severity::style) { // default severity
        -:  259:        }
        -:  260:
        -:  261:        std::string tokenlist;
        -:  262:        std::string pattern;
        -:  263:        std::string id;
        -:  264:        std::string summary;
        -:  265:        Severity::SeverityType severity;
        -:  266:    };
        -:  267:
        -:  268:    /**
        -:  269:     * @brief Extra rules
        -:  270:     */
        -:  271:    std::list<Rule> rules;
        -:  272:
        -:  273:    /** @brief show timing information (--showtime=file|summary|top5) */
        -:  274:    SHOWTIME_MODES showtime;
        -:  275:
        -:  276:    /** Struct contains standards settings */
        -:  277:    Standards standards;
        -:  278:
        -:  279:    /** @brief The output format in which the errors are printed in text mode,
        -:  280:        e.g. "{severity} {file}:{line} {message} {id}" */
        -:  281:    std::string templateFormat;
        -:  282:
        -:  283:    /** @brief The output format in which the error locations are printed in
        -:  284:     *  text mode, e.g. "{file}:{line} {info}" */
        -:  285:    std::string templateLocation;
        -:  286:
        -:  287:    /** @brief defines given by the user */
        -:  288:    std::string userDefines;
        -:  289:
        -:  290:    /** @brief undefines given by the user */
        -:  291:    std::set<std::string> userUndefs;
        -:  292:
        -:  293:    /** @brief forced includes given by the user */
        -:  294:    std::list<std::string> userIncludes;
        -:  295:
        -:  296:    /** @brief Is --verbose given? */
        -:  297:    bool verbose;
        -:  298:
        -:  299:    /** @brief write XML results (--xml) */
        -:  300:    bool xml;
        -:  301:
        -:  302:    /** @brief XML version (--xml-version=..) */
        -:  303:    int xml_version;
        -:  304:
        -:  305:    /**
        -:  306:     * @brief return true if a included file is to be excluded in Preprocessor::getConfigs
        -:  307:     * @return true for the file to be excluded.
        -:  308:     */
        -:  309:    bool configurationExcluded(const std::string &file) const {
        -:  310:        for (const std::string & configExcludePath : configExcludePaths) {
        -:  311:            if (file.length()>=configExcludePath.length() && file.compare(0,configExcludePath.length(),configExcludePath)==0) {
        -:  312:                return true;
        -:  313:            }
        -:  314:        }
        -:  315:        return false;
        -:  316:    }
        -:  317:
        -:  318:    /**
        -:  319:     * @brief Enable extra checks by id. See isEnabled()
        -:  320:     * @param str single id or list of id values to be enabled
        -:  321:     * or empty string to enable all. e.g. "style,possibleError"
        -:  322:     * @return error message. empty upon success
        -:  323:     */
        -:  324:    std::string addEnabled(const std::string &str);
        -:  325:
        -:  326:    /**
        -:  327:     * @brief Disables all severities, except from error.
        -:  328:     */
        -:  329:    void clearEnabled() {
        -:  330:        mEnabled = 0;
        -:  331:    }
        -:  332:
        -:  333:    /**
        -:  334:     * @brief Returns true if given id is in the list of
        -:  335:     * enabled extra checks (--enable)
        -:  336:     * @param group group to be enabled
        -:  337:     * @return true if the check is enabled.
        -:  338:     */
function _ZNK8Settings9isEnabledENS_12EnabledGroupE called 0 returned 0% blocks executed 0%
    #####:  339:    bool isEnabled(EnabledGroup group) const {
    #####:  340:        return (mEnabled & group) == group;
        -:  341:    }
        -:  342:
        -:  343:    /**
        -:  344:    * @brief Returns true if given severity is enabled
        -:  345:    * @return true if the check is enabled.
        -:  346:    */
        -:  347:    bool isEnabled(Severity::SeverityType severity) const;
        -:  348:
        -:  349:    /**
        -:  350:    * @brief Returns true if given value can be shown
        -:  351:    * @return true if the value can be shown
        -:  352:    */
        -:  353:    bool isEnabled(const ValueFlow::Value *value, bool inconclusiveCheck=false) const;
        -:  354:
        -:  355:    /** Is posix library specified? */
        -:  356:    bool posix() const {
        -:  357:        return std::find(libraries.begin(), libraries.end(), "posix") != libraries.end();
        -:  358:    }
        -:  359:
        -:  360:    /** @brief Request termination of checking */
        -:  361:    static void terminate(bool t = true) {
        -:  362:        Settings::mTerminated = t;
        -:  363:    }
        -:  364:
        -:  365:    /** @brief termination requested? */
function _ZN8Settings10terminatedEv called 0 returned 0% blocks executed 0%
    #####:  366:    static bool terminated() {
    #####:  367:        return Settings::mTerminated;
        -:  368:    }
        -:  369:};
        -:  370:
        -:  371:/// @}
        -:  372://---------------------------------------------------------------------------
        -:  373:#endif // settingsH
