        -:    0:Source:/home/workspace/lib/checkbufferoverrun.cpp
        -:    0:Graph:/home/workspace/build/lib/CMakeFiles/lib_objs.dir/checkbufferoverrun.gcno
        -:    0:Data:/home/workspace/build/lib/CMakeFiles/lib_objs.dir/checkbufferoverrun.gcda
        -:    0:Runs:1
        -:    0:Programs:1
        -:    1:/*
        -:    2: * Cppcheck - A tool for static C/C++ code analysis
        -:    3: * Copyright (C) 2007-2019 Cppcheck team.
        -:    4: *
        -:    5: * This program is free software: you can redistribute it and/or modify
        -:    6: * it under the terms of the GNU General Public License as published by
        -:    7: * the Free Software Foundation, either version 3 of the License, or
        -:    8: * (at your option) any later version.
        -:    9: *
        -:   10: * This program is distributed in the hope that it will be useful,
        -:   11: * but WITHOUT ANY WARRANTY; without even the implied warranty of
        -:   12: * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
        -:   13: * GNU General Public License for more details.
        -:   14: *
        -:   15: * You should have received a copy of the GNU General Public License
        -:   16: * along with this program.  If not, see <http://www.gnu.org/licenses/>.
        -:   17: */
        -:   18:
        -:   19://---------------------------------------------------------------------------
        -:   20:// Buffer overrun..
        -:   21://---------------------------------------------------------------------------
        -:   22:
        -:   23:#include "checkbufferoverrun.h"
        -:   24:
        -:   25:#include "astutils.h"
        -:   26:#include "library.h"
        -:   27:#include "mathlib.h"
        -:   28:#include "settings.h"
        -:   29:#include "symboldatabase.h"
        -:   30:#include "token.h"
        -:   31:#include "tokenize.h"
        -:   32:#include "tokenlist.h"
        -:   33:#include "utils.h"
        -:   34:#include "valueflow.h"
        -:   35:
        -:   36:#include <tinyxml2.h>
        -:   37:#include <algorithm>
        -:   38:#include <cstdlib>
        -:   39:#include <numeric> // std::accumulate
        -:   40:#include <sstream>
        -:   41:#include <stack>
        -:   42:#include <utility>
        -:   43:
        -:   44://---------------------------------------------------------------------------
        -:   45:
        -:   46:// Register this check class (by creating a static instance of it)
        -:   47:namespace {
        1:   48:    CheckBufferOverrun instance;
call    0 returned 100%
call    1 returned 100%
        -:   49:}
        -:   50:
        -:   51://---------------------------------------------------------------------------
        -:   52:
        -:   53:// CWE ids used:
        1:   54:static const CWE CWE131(131U);  // Incorrect Calculation of Buffer Size
call    0 returned 100%
        1:   55:static const CWE CWE170(170U);  // Improper Null Termination
call    0 returned 100%
        1:   56:static const CWE CWE_ARRAY_INDEX_THEN_CHECK(398U);  // Indicator of Poor Code Quality
call    0 returned 100%
        1:   57:static const CWE CWE682(682U);  // Incorrect Calculation
call    0 returned 100%
        1:   58:static const CWE CWE758(758U);  // Reliance on Undefined, Unspecified, or Implementation-Defined Behavior
call    0 returned 100%
        1:   59:static const CWE CWE_POINTER_ARITHMETIC_OVERFLOW(758U); // Reliance on Undefined, Unspecified, or Implementation-Defined Behavior
call    0 returned 100%
        1:   60:static const CWE CWE_BUFFER_UNDERRUN(786U);  // Access of Memory Location Before Start of Buffer
call    0 returned 100%
        1:   61:static const CWE CWE_BUFFER_OVERRUN(788U);   // Access of Memory Location After End of Buffer
call    0 returned 100%
        -:   62:
        -:   63://---------------------------------------------------------------------------
        -:   64:
function _ZL18getBufferSizeValuePK5Token called 0 returned 0% blocks executed 0%
    #####:   65:static const ValueFlow::Value *getBufferSizeValue(const Token *tok)
        -:   66:{
    #####:   67:    const std::list<ValueFlow::Value> &tokenValues = tok->values();
call    0 never executed
    #####:   68:    const auto it = std::find_if(tokenValues.begin(), tokenValues.end(), std::mem_fn(&ValueFlow::Value::isBufferSizeValue));
call    0 never executed
call    1 never executed
call    2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
call    7 never executed
call    8 never executed
call    9 never executed
    #####:   69:    return it == tokenValues.end() ? nullptr : &*it;
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
call    5 never executed
call    6 never executed
        -:   70:}
        -:   71:
function _ZL30getMinFormatStringOutputLengthRKNSt7__debug6vectorIPK5TokenSaIS3_EEEi called 0 returned 0% blocks executed 0%
    #####:   72:static int getMinFormatStringOutputLength(const std::vector<const Token*> &parameters, nonneg int formatStringArgNr)
        -:   73:{
    #####:   74:    if (formatStringArgNr <= 0 || formatStringArgNr > parameters.size())
branch  0 never executed
branch  1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
    #####:   75:        return 0;
    #####:   76:    if (parameters[formatStringArgNr - 1]->tokType() != Token::eString)
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
    #####:   77:        return 0;
    #####:   78:    const std::string &formatString = parameters[formatStringArgNr - 1]->str();
call    0 never executed
call    1 never executed
    #####:   79:    bool percentCharFound = false;
    #####:   80:    int outputStringSize = 0;
    #####:   81:    bool handleNextParameter = false;
    #####:   82:    std::string digits_string;
call    0 never executed
call    1 never executed
call    2 never executed
    #####:   83:    bool i_d_x_f_found = false;
    #####:   84:    int parameterLength = 0;
    #####:   85:    int inputArgNr = formatStringArgNr;
    #####:   86:    for (int i = 1; i + 1 < formatString.length(); ++i) {
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:   87:        if (formatString[i] == '\\') {
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:   88:            if (i < formatString.length() - 1 && formatString[i + 1] == '0')
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
    #####:   89:                break;
        -:   90:
    #####:   91:            ++outputStringSize;
    #####:   92:            ++i;
    #####:   93:            continue;
        -:   94:        }
        -:   95:
    #####:   96:        if (percentCharFound) {
branch  0 never executed
branch  1 never executed
    #####:   97:            switch (formatString[i]) {
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
branch  5 never executed
    #####:   98:            case 'f':
        -:   99:            case 'x':
        -:  100:            case 'X':
        -:  101:            case 'i':
    #####:  102:                i_d_x_f_found = true;
    #####:  103:                handleNextParameter = true;
    #####:  104:                parameterLength = 1; // TODO
    #####:  105:                break;
    #####:  106:            case 'c':
        -:  107:            case 'e':
        -:  108:            case 'E':
        -:  109:            case 'g':
        -:  110:            case 'o':
        -:  111:            case 'u':
        -:  112:            case 'p':
        -:  113:            case 'n':
    #####:  114:                handleNextParameter = true;
    #####:  115:                parameterLength = 1; // TODO
    #####:  116:                break;
    #####:  117:            case 'd':
    #####:  118:                i_d_x_f_found = true;
    #####:  119:                parameterLength = 1;
    #####:  120:                if (inputArgNr < parameters.size() && parameters[inputArgNr]->hasKnownIntValue())
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
call    4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
branch  8 never executed
branch  9 never executed
branch 10 never executed
    #####:  121:                    parameterLength = MathLib::toString(parameters[inputArgNr]->getKnownIntValue()).length();
call    0 never executed
call    1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
call    6 never executed
        -:  122:
    #####:  123:                handleNextParameter = true;
    #####:  124:                break;
    #####:  125:            case 's':
    #####:  126:                parameterLength = 0;
    #####:  127:                if (inputArgNr < parameters.size() && parameters[inputArgNr]->tokType() == Token::eString)
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
call    4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
branch  8 never executed
    #####:  128:                    parameterLength = Token::getStrLength(parameters[inputArgNr]);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
        -:  129:
    #####:  130:                handleNextParameter = true;
    #####:  131:                break;
        -:  132:            }
        -:  133:        }
        -:  134:
    #####:  135:        if (formatString[i] == '%')
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  136:            percentCharFound = !percentCharFound;
    #####:  137:        else if (percentCharFound) {
branch  0 never executed
branch  1 never executed
    #####:  138:            digits_string.append(1, formatString[i]);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
        -:  139:        }
        -:  140:
    #####:  141:        if (!percentCharFound)
branch  0 never executed
branch  1 never executed
    #####:  142:            outputStringSize++;
        -:  143:
    #####:  144:        if (handleNextParameter) {
branch  0 never executed
branch  1 never executed
    #####:  145:            int tempDigits = std::abs(std::atoi(digits_string.c_str()));
call    0 never executed
    #####:  146:            if (i_d_x_f_found)
branch  0 never executed
branch  1 never executed
    #####:  147:                tempDigits = std::max(tempDigits, 1);
call    0 never executed
        -:  148:
    #####:  149:            if (digits_string.find('.') != std::string::npos) {
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  150:                const std::string endStr = digits_string.substr(digits_string.find('.') + 1);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
    #####:  151:                const int maxLen = std::max(std::abs(std::atoi(endStr.c_str())), 1);
call    0 never executed
call    1 never executed
        -:  152:
    #####:  153:                if (formatString[i] == 's') {
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:  154:                    // For strings, the length after the dot "%.2s" will limit
        -:  155:                    // the length of the string.
    #####:  156:                    if (parameterLength > maxLen)
branch  0 never executed
branch  1 never executed
    #####:  157:                        parameterLength = maxLen;
        -:  158:                } else {
        -:  159:                    // For integers, the length after the dot "%.2d" can
        -:  160:                    // increase required length
    #####:  161:                    if (tempDigits < maxLen)
branch  0 never executed
branch  1 never executed
    #####:  162:                        tempDigits = maxLen;
        -:  163:                }
        -:  164:            }
        -:  165:
    #####:  166:            if (tempDigits < parameterLength)
branch  0 never executed
branch  1 never executed
    #####:  167:                outputStringSize += parameterLength;
        -:  168:            else
    #####:  169:                outputStringSize += tempDigits;
        -:  170:
    #####:  171:            parameterLength = 0;
    #####:  172:            digits_string.clear();
call    0 never executed
    #####:  173:            i_d_x_f_found = false;
    #####:  174:            percentCharFound = false;
    #####:  175:            handleNextParameter = false;
    #####:  176:            ++inputArgNr;
        -:  177:        }
        -:  178:    }
        -:  179:
    #####:  180:    return outputStringSize;
        -:  181:}
        -:  182:
        -:  183://---------------------------------------------------------------------------
        -:  184:
function _ZL16getDimensionsEtcPK5TokenPK8SettingsPNSt7__debug6vectorI9DimensionSaIS7_EEEPNS5_4listISt4pairIS1_NSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEESaISJ_EEEPb called 0 returned 0% blocks executed 0%
    #####:  185:static bool getDimensionsEtc(const Token * const arrayToken, const Settings *settings, std::vector<Dimension> * const dimensions, ErrorPath * const errorPath, bool * const mightBeLarger)
        -:  186:{
    #####:  187:    const Token *array = arrayToken;
    #####:  188:    while (Token::Match(array, ".|::"))
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  189:        array = array->astOperand2();
call    0 never executed
        -:  190:
    #####:  191:    if (!array->variable())
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  192:        return false;
        -:  193:
    #####:  194:    if (array->variable()->isArray() && !array->variable()->dimensions().empty()) {
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
call    5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
branch  9 never executed
branch 10 never executed
    #####:  195:        *dimensions = array->variable()->dimensions();
call    0 never executed
call    1 never executed
call    2 never executed
    #####:  196:        if (dimensions->size() >= 1 && ((*dimensions)[0].num <= 1 || !(*dimensions)[0].tok)) {
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
branch  9 never executed
branch 10 never executed
    #####:  197:            visitAstNodes(arrayToken,
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
call    5 never executed
call    6 never executed
call    7 never executed
function _ZZL16getDimensionsEtcPK5TokenPK8SettingsPNSt7__debug6vectorI9DimensionSaIS7_EEEPNS5_4listISt4pairIS1_NSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEESaISJ_EEEPbENKUlS1_E_clES1_ called 0 returned 0% blocks executed 0%
    #####:  198:            [&](const Token *child) {
    #####:  199:                if (child->originalName() == "->") {
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
    #####:  200:                    *mightBeLarger = true;
    #####:  201:                    return ChildrenToVisit::none;
        -:  202:                }
    #####:  203:                return ChildrenToVisit::op1_and_op2;
        -:  204:            });
        -:  205:        }
    #####:  206:    } else if (const Token *stringLiteral = array->getValueTokenMinStrSize()) {
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  207:        Dimension dim;
call    0 never executed
    #####:  208:        dim.tok = nullptr;
    #####:  209:        dim.num = Token::getStrSize(stringLiteral);
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  210:        dim.known = array->hasKnownValue();
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  211:        dimensions->emplace_back(dim);
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  212:    } else if (array->valueType() && array->valueType()->pointer >= 1 && array->valueType()->isIntegral()) {
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
call    7 never executed
branch  8 never executed
branch  9 never executed
branch 10 never executed
branch 11 never executed
    #####:  213:        const ValueFlow::Value *value = getBufferSizeValue(array);
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  214:        if (!value)
branch  0 never executed
branch  1 never executed
    #####:  215:            return false;
    #####:  216:        *errorPath = value->errorPath;
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  217:        Dimension dim;
call    0 never executed
    #####:  218:        dim.known = value->isKnown();
call    0 never executed
    #####:  219:        dim.tok = nullptr;
    #####:  220:        dim.num = value->intvalue / array->valueType()->typeSize(*settings);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
    #####:  221:        dimensions->emplace_back(dim);
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:  222:    }
    #####:  223:    return !dimensions->empty();
call    0 never executed
        -:  224:}
        -:  225:
function _ZL21getOverrunIndexValuesPK5TokenS1_RKNSt7__debug6vectorI9DimensionSaIS4_EEERKNS3_IS1_SaIS1_EEE called 0 returned 0% blocks executed 0%
    #####:  226:static std::vector<const ValueFlow::Value *> getOverrunIndexValues(const Token *tok, const Token *arrayToken, const std::vector<Dimension> &dimensions, const std::vector<const Token *> &indexTokens)
        -:  227:{
    #####:  228:    const Token *array = arrayToken;
    #####:  229:    while (Token::Match(array, ".|::"))
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  230:        array = array->astOperand2();
call    0 never executed
        -:  231:
    #####:  232:    for (int cond = 0; cond < 2; cond++) {
branch  0 never executed
branch  1 never executed
    #####:  233:        bool equal = false;
    #####:  234:        bool overflow = false;
    #####:  235:        bool allKnown = true;
    #####:  236:        std::vector<const ValueFlow::Value *> indexValues;
call    0 never executed
call    1 never executed
    #####:  237:        for (int i = 0; i < dimensions.size() && i < indexTokens.size(); ++i) {
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
    #####:  238:            const ValueFlow::Value *value = indexTokens[i]->getMaxValue(cond == 1);
call    0 never executed
call    1 never executed
    #####:  239:            indexValues.push_back(value);
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  240:            if (!value)
branch  0 never executed
branch  1 never executed
    #####:  241:                continue;
    #####:  242:            if (!value->isKnown()) {
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  243:                if (!allKnown)
branch  0 never executed
branch  1 never executed
    #####:  244:                    continue;
    #####:  245:                allKnown = false;
        -:  246:            }
    #####:  247:            if (array->variable()->isArray() && dimensions[i].num == 0)
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
branch  8 never executed
    #####:  248:                continue;
    #####:  249:            if (value->intvalue == dimensions[i].num)
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  250:                equal = true;
    #####:  251:            else if (value->intvalue > dimensions[i].num)
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  252:                overflow = true;
        -:  253:        }
    #####:  254:        if (equal && tok->str() != "[")
branch  0 never executed
branch  1 never executed
call    2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
    #####:  255:            continue;
    #####:  256:        if (!overflow && equal) {
branch  0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
    #####:  257:            const Token *parent = tok;
    #####:  258:            while (Token::simpleMatch(parent, "["))
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
    #####:  259:                parent = parent->astParent();
call    0 never executed
    #####:  260:            if (!parent || parent->isUnaryOp("&"))
branch  0 never executed
branch  1 never executed
call    2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
branch  9 never executed
branch 10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
branch 17 never executed
branch 18 never executed
branch 19 never executed
branch 20 never executed
call   21 never executed
branch 22 never executed
branch 23 never executed
call   24 never executed
    #####:  261:                continue;
        -:  262:        }
    #####:  263:        if (overflow || equal)
branch  0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
    #####:  264:            return indexValues;
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
        -:  265:    }
        -:  266:
    #####:  267:    return std::vector<const ValueFlow::Value *>();
call    0 never executed
        -:  268:}
        -:  269:
function _ZN18CheckBufferOverrun10arrayIndexEv called 0 returned 0% blocks executed 0%
    #####:  270:void CheckBufferOverrun::arrayIndex()
        -:  271:{
    #####:  272:    for (const Token *tok = mTokenizer->tokens(); tok; tok = tok->next()) {
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  273:        if (tok->str() != "[")
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
    #####:  274:            continue;
    #####:  275:        const Token *array = tok->astOperand1();
call    0 never executed
    #####:  276:        while (Token::Match(array, ".|::"))
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
    #####:  277:            array = array->astOperand2();
call    0 never executed
    #####:  278:        if (!array|| !array->variable() || array->variable()->nameToken() == array)
branch  0 never executed
branch  1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
branch  9 never executed
branch 10 never executed
    #####:  279:            continue;
    #####:  280:        if (!array->scope()->isExecutable()) {
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
        -:  281:            // LHS in non-executable scope => This is just a definition
    #####:  282:            const Token *parent = tok;
    #####:  283:            while (parent && !Token::simpleMatch(parent->astParent(), "="))
branch  0 never executed
branch  1 never executed
call    2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
branch  8 never executed
branch  9 never executed
    #####:  284:                parent = parent->astParent();
call    0 never executed
    #####:  285:            if (!parent || parent == parent->astParent()->astOperand1())
branch  0 never executed
branch  1 never executed
call    2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
    #####:  286:                continue;
        -:  287:        }
        -:  288:
    #####:  289:        if (astIsContainer(array))
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
    #####:  290:            continue;
        -:  291:
    #####:  292:        std::vector<const Token *> indexTokens;
call    0 never executed
call    1 never executed
    #####:  293:        for (const Token *tok2 = tok; tok2 && tok2->str() == "["; tok2 = tok2->link()->next()) {
branch  0 never executed
branch  1 never executed
call    2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
call    8 never executed
call    9 never executed
    #####:  294:            if (!tok2->astOperand2()) {
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  295:                indexTokens.clear();
call    0 never executed
    #####:  296:                break;
        -:  297:            }
    #####:  298:            indexTokens.emplace_back(tok2->astOperand2());
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
        -:  299:        }
    #####:  300:        if (indexTokens.empty())
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  301:            continue;
        -:  302:
    #####:  303:        std::vector<Dimension> dimensions;
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
    #####:  304:        ErrorPath errorPath;
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
    #####:  305:        bool mightBeLarger = false;
    #####:  306:        if (!getDimensionsEtc(tok->astOperand1(), mSettings, &dimensions, &errorPath, &mightBeLarger))
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
branch  5 never executed
    #####:  307:            continue;
        -:  308:
        -:  309:        // Positive index
    #####:  310:        if (!mightBeLarger) { // TODO check arrays with dim 1 also
branch  0 never executed
branch  1 never executed
    #####:  311:            const std::vector<const ValueFlow::Value *> &indexValues = getOverrunIndexValues(tok, tok->astOperand1(), dimensions, indexTokens);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
call    5 never executed
    #####:  312:            if (!indexValues.empty())
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  313:                arrayIndexError(tok, dimensions, indexValues);
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:  314:        }
        -:  315:
        -:  316:        // Negative index
    #####:  317:        bool neg = false;
    #####:  318:        std::vector<const ValueFlow::Value *> negativeIndexes;
call    0 never executed
call    1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
    #####:  319:        for (const Token * indexToken : indexTokens) {
call    0 never executed
call    1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
call    6 never executed
call    7 never executed
call    8 never executed
call    9 never executed
call   10 never executed
    #####:  320:            const ValueFlow::Value *negativeValue = indexToken->getValueLE(-1, mSettings);
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  321:            negativeIndexes.emplace_back(negativeValue);
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  322:            if (negativeValue)
branch  0 never executed
branch  1 never executed
    #####:  323:                neg = true;
        -:  324:        }
    #####:  325:        if (neg) {
branch  0 never executed
branch  1 never executed
    #####:  326:            negativeIndexError(tok, dimensions, negativeIndexes);
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:  327:        }
        -:  328:    }
    #####:  329:}
        -:  330:
function _ZL16stringifyIndexesRKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEERKNSt7__debug6vectorIPKN9ValueFlow5ValueESaISC_EEE called 0 returned 0% blocks executed 0%
    #####:  331:static std::string stringifyIndexes(const std::string &array, const std::vector<const ValueFlow::Value *> &indexValues)
        -:  332:{
    #####:  333:    if (indexValues.size() == 1)
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  334:        return MathLib::toString(indexValues[0]->intvalue);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
        -:  335:
    #####:  336:    std::ostringstream ret;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
call    4 never executed
    #####:  337:    ret << array;
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  338:    for (const ValueFlow::Value *index : indexValues) {
call    0 never executed
call    1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
call    6 never executed
call    7 never executed
call    8 never executed
call    9 never executed
call   10 never executed
    #####:  339:        ret << "[";
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  340:        if (index)
branch  0 never executed
branch  1 never executed
    #####:  341:            ret << index->intvalue;
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:  342:        else
    #####:  343:            ret << "*";
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  344:        ret << "]";
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:  345:    }
    #####:  346:    return ret.str();
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:  347:}
        -:  348:
function _ZL17arrayIndexMessagePK5TokenRKNSt7__debug6vectorI9DimensionSaIS4_EEERKNS3_IPKN9ValueFlow5ValueESaISC_EEES1_ called 0 returned 0% blocks executed 0%
    #####:  349:static std::string arrayIndexMessage(const Token *tok, const std::vector<Dimension> &dimensions, const std::vector<const ValueFlow::Value *> &indexValues, const Token *condition)
        -:  350:{
function _ZZL17arrayIndexMessagePK5TokenRKNSt7__debug6vectorI9DimensionSaIS4_EEERKNS3_IPKN9ValueFlow5ValueESaISC_EEES1_ENKUlRKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEERKS4_E_clESO_SQ_ called 0 returned 0% blocks executed 0%
    #####:  351:    auto add_dim = [](const std::string &s, const Dimension &dim) {
    #####:  352:        return s + "[" + MathLib::toString(dim.num) + "]";
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
branch  5 never executed
branch  6 never executed
call    7 never executed
call    8 never executed
call    9 never executed
call   10 never executed
call   11 never executed
call   12 never executed
    #####:  353:    };
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  354:    const std::string array = std::accumulate(dimensions.begin(), dimensions.end(), tok->astOperand1()->expressionString(), add_dim);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
call    5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
call    9 never executed
call   10 never executed
call   11 never executed
call   12 never executed
call   13 never executed
call   14 never executed
call   15 never executed
        -:  355:
    #####:  356:    std::ostringstream errmsg;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
call    4 never executed
    #####:  357:    if (condition)
branch  0 never executed
branch  1 never executed
    #####:  358:        errmsg << ValueFlow::eitherTheConditionIsRedundant(condition)
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
call    4 never executed
    #####:  359:               << " or the array '" + array + "' is accessed at index " << stringifyIndexes(tok->astOperand1()->expressionString(), indexValues) << ", which is out of bounds.";
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
call    9 never executed
branch 10 never executed
branch 11 never executed
call   12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
branch 17 never executed
branch 18 never executed
call   19 never executed
branch 20 never executed
branch 21 never executed
call   22 never executed
branch 23 never executed
branch 24 never executed
call   25 never executed
call   26 never executed
call   27 never executed
call   28 never executed
call   29 never executed
call   30 never executed
call   31 never executed
call   32 never executed
        -:  360:    else
    #####:  361:        errmsg << "Array '" << array << "' accessed at index " << stringifyIndexes(tok->astOperand1()->expressionString(), indexValues) <<  ", which is out of bounds.";
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
call    9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
branch 17 never executed
branch 18 never executed
call   19 never executed
branch 20 never executed
branch 21 never executed
call   22 never executed
call   23 never executed
call   24 never executed
call   25 never executed
        -:  362:
    #####:  363:    return errmsg.str();
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
        -:  364:}
        -:  365:
function _ZN18CheckBufferOverrun15arrayIndexErrorEPK5TokenRKNSt7__debug6vectorI9DimensionSaIS5_EEERKNS4_IPKN9ValueFlow5ValueESaISD_EEE called 0 returned 0% blocks executed 0%
    #####:  366:void CheckBufferOverrun::arrayIndexError(const Token *tok, const std::vector<Dimension> &dimensions, const std::vector<const ValueFlow::Value *> &indexes)
        -:  367:{
    #####:  368:    if (!tok) {
branch  0 never executed
branch  1 never executed
    #####:  369:        reportError(tok, Severity::error, "arrayIndexOutOfBounds", "Array 'arr[16]' accessed at index 16, which is out of bounds.", CWE_BUFFER_OVERRUN, false);
call    0 never executed
    #####:  370:        reportError(tok, Severity::warning, "arrayIndexOutOfBoundsCond", "Array 'arr[16]' accessed at index 16, which is out of bounds.", CWE_BUFFER_OVERRUN, false);
call    0 never executed
    #####:  371:        return;
        -:  372:    }
        -:  373:
    #####:  374:    const Token *condition = nullptr;
    #####:  375:    const ValueFlow::Value *index = nullptr;
    #####:  376:    for (const ValueFlow::Value *indexValue: indexes) {
call    0 never executed
call    1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
call    6 never executed
call    7 never executed
branch  8 never executed
branch  9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
    #####:  377:        if (!indexValue)
branch  0 never executed
branch  1 never executed
    #####:  378:            continue;
    #####:  379:        if (!indexValue->errorSeverity() && !mSettings->isEnabled(Settings::WARNING))
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
    #####:  380:            return;
    #####:  381:        if (indexValue->condition)
branch  0 never executed
branch  1 never executed
    #####:  382:            condition = indexValue->condition;
    #####:  383:        if (!index || !indexValue->errorPath.empty())
branch  0 never executed
branch  1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
    #####:  384:            index = indexValue;
        -:  385:    }
        -:  386:
    #####:  387:    reportError(getErrorPath(tok, index, "Array index out of bounds"),
branch  0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
call    5 never executed
branch  6 never executed
branch  7 never executed
call    8 never executed
branch  9 never executed
branch 10 never executed
call   11 never executed
branch 12 never executed
branch 13 never executed
call   14 never executed
call   15 never executed
call   16 never executed
call   17 never executed
call   18 never executed
call   19 never executed
    #####:  388:                index->errorSeverity() ? Severity::error : Severity::warning,
call    0 never executed
    #####:  389:                index->condition ? "arrayIndexOutOfBoundsCond" : "arrayIndexOutOfBounds",
    #####:  390:                arrayIndexMessage(tok, dimensions, indexes, condition),
call    0 never executed
call    1 never executed
call    2 never executed
        -:  391:                CWE_BUFFER_OVERRUN,
    #####:  392:                index->isInconclusive());
call    0 never executed
        -:  393:}
        -:  394:
function _ZN18CheckBufferOverrun18negativeIndexErrorEPK5TokenRKNSt7__debug6vectorI9DimensionSaIS5_EEERKNS4_IPKN9ValueFlow5ValueESaISD_EEE called 0 returned 0% blocks executed 0%
    #####:  395:void CheckBufferOverrun::negativeIndexError(const Token *tok, const std::vector<Dimension> &dimensions, const std::vector<const ValueFlow::Value *> &indexes)
        -:  396:{
    #####:  397:    if (!tok) {
branch  0 never executed
branch  1 never executed
    #####:  398:        reportError(tok, Severity::error, "negativeIndex", "Negative array index", CWE_BUFFER_UNDERRUN, false);
call    0 never executed
    #####:  399:        return;
        -:  400:    }
        -:  401:
    #####:  402:    const Token *condition = nullptr;
    #####:  403:    const ValueFlow::Value *negativeValue = nullptr;
    #####:  404:    for (const ValueFlow::Value *indexValue: indexes) {
call    0 never executed
call    1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
call    6 never executed
call    7 never executed
branch  8 never executed
branch  9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
    #####:  405:        if (!indexValue)
branch  0 never executed
branch  1 never executed
    #####:  406:            continue;
    #####:  407:        if (!indexValue->errorSeverity() && !mSettings->isEnabled(Settings::WARNING))
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
    #####:  408:            return;
    #####:  409:        if (indexValue->condition)
branch  0 never executed
branch  1 never executed
    #####:  410:            condition = indexValue->condition;
    #####:  411:        if (!negativeValue || !indexValue->errorPath.empty())
branch  0 never executed
branch  1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
    #####:  412:            negativeValue = indexValue;
        -:  413:    }
        -:  414:
    #####:  415:    reportError(getErrorPath(tok, negativeValue, "Negative array index"),
branch  0 never executed
branch  1 never executed
call    2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
call    9 never executed
branch 10 never executed
branch 11 never executed
call   12 never executed
call   13 never executed
call   14 never executed
call   15 never executed
call   16 never executed
call   17 never executed
    #####:  416:                negativeValue->errorSeverity() ? Severity::error : Severity::warning,
call    0 never executed
        -:  417:                "negativeIndex",
    #####:  418:                arrayIndexMessage(tok, dimensions, indexes, condition),
call    0 never executed
call    1 never executed
call    2 never executed
        -:  419:                CWE_BUFFER_UNDERRUN,
    #####:  420:                negativeValue->isInconclusive());
call    0 never executed
        -:  421:}
        -:  422:
        -:  423://---------------------------------------------------------------------------
        -:  424:
function _ZN18CheckBufferOverrun17pointerArithmeticEv called 0 returned 0% blocks executed 0%
    #####:  425:void CheckBufferOverrun::pointerArithmetic()
        -:  426:{
    #####:  427:    if (!mSettings->isEnabled(Settings::PORTABILITY))
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  428:        return;
        -:  429:
    #####:  430:    for (const Token *tok = mTokenizer->tokens(); tok; tok = tok->next()) {
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
call    4 never executed
    #####:  431:        if (!Token::Match(tok, "+|-"))
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
    #####:  432:            continue;
    #####:  433:        if (!tok->valueType() || tok->valueType()->pointer == 0)
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
    #####:  434:            continue;
    #####:  435:        if (!tok->astOperand1() || !tok->astOperand2())
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
    #####:  436:            continue;
    #####:  437:        if (!tok->astOperand1()->valueType() || !tok->astOperand2()->valueType())
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
call    5 never executed
branch  6 never executed
branch  7 never executed
branch  8 never executed
branch  9 never executed
    #####:  438:            continue;
        -:  439:
        -:  440:        const Token *arrayToken, *indexToken;
    #####:  441:        if (tok->astOperand1()->valueType()->pointer > 0) {
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
    #####:  442:            arrayToken = tok->astOperand1();
call    0 never executed
    #####:  443:            indexToken = tok->astOperand2();
call    0 never executed
        -:  444:        } else {
    #####:  445:            arrayToken = tok->astOperand2();
call    0 never executed
    #####:  446:            indexToken = tok->astOperand1();
call    0 never executed
        -:  447:        }
        -:  448:
    #####:  449:        if (!indexToken || !indexToken->valueType() || indexToken->valueType()->pointer > 0 || !indexToken->valueType()->isIntegral())
branch  0 never executed
branch  1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
branch  6 never executed
branch  7 never executed
call    8 never executed
call    9 never executed
branch 10 never executed
branch 11 never executed
branch 12 never executed
branch 13 never executed
    #####:  450:            continue;
        -:  451:
    #####:  452:        std::vector<Dimension> dimensions;
call    0 never executed
call    1 never executed
    #####:  453:        ErrorPath errorPath;
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
    #####:  454:        bool mightBeLarger = false;
    #####:  455:        if (!getDimensionsEtc(arrayToken, mSettings, &dimensions, &errorPath, &mightBeLarger))
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
    #####:  456:            continue;
        -:  457:
    #####:  458:        if (tok->str() == "+") {
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
        -:  459:            // Positive index
    #####:  460:            if (!mightBeLarger) { // TODO check arrays with dim 1 also
branch  0 never executed
branch  1 never executed
    #####:  461:                const std::vector<const Token *> indexTokens{indexToken};
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
call    5 never executed
call    6 never executed
    #####:  462:                const std::vector<const ValueFlow::Value *> &indexValues = getOverrunIndexValues(tok, arrayToken, dimensions, indexTokens);
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
call    4 never executed
    #####:  463:                if (!indexValues.empty())
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  464:                    pointerArithmeticError(tok, indexToken, indexValues.front());
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
        -:  465:            }
        -:  466:
    #####:  467:            if (const ValueFlow::Value *neg = indexToken->getValueLE(-1, mSettings))
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
    #####:  468:                pointerArithmeticError(tok, indexToken, neg);
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  469:        } else if (tok->str() == "-") {
call    0 never executed
call    1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
        -:  470:            // TODO
        -:  471:        }
        -:  472:    }
        -:  473:}
        -:  474:
function _ZN18CheckBufferOverrun22pointerArithmeticErrorEPK5TokenS2_PKN9ValueFlow5ValueE called 0 returned 0% blocks executed 0%
    #####:  475:void CheckBufferOverrun::pointerArithmeticError(const Token *tok, const Token *indexToken, const ValueFlow::Value *indexValue)
        -:  476:{
    #####:  477:    if (!tok) {
branch  0 never executed
branch  1 never executed
    #####:  478:        reportError(tok, Severity::portability, "pointerOutOfBounds", "Pointer arithmetic overflow.", CWE_POINTER_ARITHMETIC_OVERFLOW, false);
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  479:        reportError(tok, Severity::portability, "pointerOutOfBoundsCond", "Pointer arithmetic overflow.", CWE_POINTER_ARITHMETIC_OVERFLOW, false);
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  480:        return;
        -:  481:    }
        -:  482:
    #####:  483:    std::string errmsg;
call    0 never executed
call    1 never executed
call    2 never executed
    #####:  484:    if (indexValue->condition)
branch  0 never executed
branch  1 never executed
    #####:  485:        errmsg = "Undefined behaviour, when '" + indexToken->expressionString() + "' is " + MathLib::toString(indexValue->intvalue) + " the pointer arithmetic '" + tok->expressionString() + "' is out of bounds.";
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
call    9 never executed
branch 10 never executed
branch 11 never executed
call   12 never executed
branch 13 never executed
branch 14 never executed
call   15 never executed
branch 16 never executed
branch 17 never executed
call   18 never executed
branch 19 never executed
branch 20 never executed
call   21 never executed
branch 22 never executed
branch 23 never executed
call   24 never executed
branch 25 never executed
branch 26 never executed
call   27 never executed
call   28 never executed
call   29 never executed
call   30 never executed
call   31 never executed
call   32 never executed
call   33 never executed
call   34 never executed
call   35 never executed
call   36 never executed
call   37 never executed
call   38 never executed
call   39 never executed
call   40 never executed
call   41 never executed
call   42 never executed
call   43 never executed
call   44 never executed
        -:  486:    else
    #####:  487:        errmsg = "Undefined behaviour, pointer arithmetic '" + tok->expressionString() + "' is out of bounds.";
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
call    9 never executed
call   10 never executed
call   11 never executed
call   12 never executed
call   13 never executed
call   14 never executed
        -:  488:
    #####:  489:    reportError(getErrorPath(tok, indexValue, "Pointer arithmetic overflow"),
branch  0 never executed
branch  1 never executed
call    2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
call    9 never executed
branch 10 never executed
branch 11 never executed
call   12 never executed
call   13 never executed
call   14 never executed
call   15 never executed
call   16 never executed
call   17 never executed
        -:  490:                Severity::portability,
    #####:  491:                indexValue->condition ? "pointerOutOfBoundsCond" : "pointerOutOfBounds",
        -:  492:                errmsg,
        -:  493:                CWE_POINTER_ARITHMETIC_OVERFLOW,
    #####:  494:                indexValue->isInconclusive());
call    0 never executed
        -:  495:}
        -:  496:
        -:  497://---------------------------------------------------------------------------
        -:  498:
function _ZNK18CheckBufferOverrun13getBufferSizeEPK5Token called 0 returned 0% blocks executed 0%
    #####:  499:ValueFlow::Value CheckBufferOverrun::getBufferSize(const Token *bufTok) const
        -:  500:{
    #####:  501:    if (!bufTok->valueType())
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  502:        return ValueFlow::Value(-1);
call    0 never executed
    #####:  503:    const Variable *var = bufTok->variable();
call    0 never executed
        -:  504:
    #####:  505:    if (!var || var->dimensions().empty()) {
branch  0 never executed
branch  1 never executed
call    2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
    #####:  506:        const ValueFlow::Value *value = getBufferSizeValue(bufTok);
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  507:        if (value)
branch  0 never executed
branch  1 never executed
    #####:  508:            return *value;
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:  509:    }
        -:  510:
    #####:  511:    if (!var)
branch  0 never executed
branch  1 never executed
    #####:  512:        return ValueFlow::Value(-1);
call    0 never executed
        -:  513:
function _ZZNK18CheckBufferOverrun13getBufferSizeEPK5TokenENKUlxRK9DimensionE_clExS5_ called 0 returned 0% blocks executed 0%
    #####:  514:    MathLib::bigint dim = std::accumulate(var->dimensions().begin(), var->dimensions().end(), 1LL, [](MathLib::bigint i1, const Dimension &dim) {
call    0 never executed
call    1 never executed
call    2 never executed
call    3 never executed
call    4 never executed
call    5 never executed
call    6 never executed
call    7 never executed
    #####:  515:        return i1 * dim.num;
    #####:  516:    });
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:  517:
    #####:  518:    ValueFlow::Value v;
call    0 never executed
call    1 never executed
call    2 never executed
    #####:  519:    v.setKnown();
call    0 never executed
    #####:  520:    v.valueType = ValueFlow::Value::ValueType::BUFFER_SIZE;
        -:  521:
    #####:  522:    if (var->isPointerArray())
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
    #####:  523:        v.intvalue = dim * mSettings->sizeof_pointer;
    #####:  524:    else if (var->isPointer())
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  525:        return ValueFlow::Value(-1);
call    0 never executed
        -:  526:    else {
    #####:  527:        const MathLib::bigint typeSize = bufTok->valueType()->typeSize(*mSettings);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
    #####:  528:        v.intvalue = dim * typeSize;
        -:  529:    }
        -:  530:
    #####:  531:    return v;
call    0 never executed
        -:  532:}
        -:  533://---------------------------------------------------------------------------
        -:  534:
function _ZL15checkBufferSizePK5TokenRKN7Library14ArgumentChecks7MinSizeERKNSt7__debug6vectorIS1_SaIS1_EEExPK8Settings called 0 returned 0% blocks executed 0%
    #####:  535:static bool checkBufferSize(const Token *ftok, const Library::ArgumentChecks::MinSize &minsize, const std::vector<const Token *> &args, const MathLib::bigint bufferSize, const Settings *settings)
        -:  536:{
    #####:  537:    const Token * const arg = (minsize.arg > 0 && minsize.arg - 1 < args.size()) ? args[minsize.arg - 1] : nullptr;
branch  0 never executed
branch  1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
    #####:  538:    const Token * const arg2 = (minsize.arg2 > 0 && minsize.arg2 - 1 < args.size()) ? args[minsize.arg2 - 1] : nullptr;
branch  0 never executed
branch  1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
        -:  539:
    #####:  540:    switch (minsize.type) {
branch  0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
    #####:  541:    case Library::ArgumentChecks::MinSize::Type::STRLEN:
    #####:  542:        if (settings->library.isargformatstr(ftok, minsize.arg)) {
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  543:            return getMinFormatStringOutputLength(args, minsize.arg) < bufferSize;
call    0 never executed
    #####:  544:        } else if (arg) {
branch  0 never executed
branch  1 never executed
    #####:  545:            const Token *strtoken = arg->getValueTokenMaxStrLength();
call    0 never executed
    #####:  546:            if (strtoken)
branch  0 never executed
branch  1 never executed
    #####:  547:                return Token::getStrLength(strtoken) < bufferSize;
call    0 never executed
        -:  548:        }
    #####:  549:        break;
    #####:  550:    case Library::ArgumentChecks::MinSize::Type::ARGVALUE:
    #####:  551:        if (arg && arg->hasKnownIntValue())
branch  0 never executed
branch  1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
    #####:  552:            return arg->getKnownIntValue() <= bufferSize;
call    0 never executed
    #####:  553:        break;
    #####:  554:    case Library::ArgumentChecks::MinSize::Type::SIZEOF:
        -:  555:        // TODO
    #####:  556:        break;
    #####:  557:    case Library::ArgumentChecks::MinSize::Type::MUL:
    #####:  558:        if (arg && arg2 && arg->hasKnownIntValue() && arg2->hasKnownIntValue())
branch  0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
branch  5 never executed
branch  6 never executed
call    7 never executed
branch  8 never executed
branch  9 never executed
branch 10 never executed
branch 11 never executed
    #####:  559:            return (arg->getKnownIntValue() * arg2->getKnownIntValue()) <= bufferSize;
call    0 never executed
call    1 never executed
    #####:  560:        break;
    #####:  561:    case Library::ArgumentChecks::MinSize::Type::VALUE:
    #####:  562:        return minsize.value <= bufferSize;
    #####:  563:    case Library::ArgumentChecks::MinSize::Type::NONE:
    #####:  564:        break;
        -:  565:    };
    #####:  566:    return true;
        -:  567:}
        -:  568:
        -:  569:
function _ZN18CheckBufferOverrun14bufferOverflowEv called 0 returned 0% blocks executed 0%
    #####:  570:void CheckBufferOverrun::bufferOverflow()
        -:  571:{
    #####:  572:    const SymbolDatabase *symbolDatabase = mTokenizer->getSymbolDatabase();
call    0 never executed
    #####:  573:    for (const Scope * scope : symbolDatabase->functionScopes) {
call    0 never executed
call    1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
call    6 never executed
call    7 never executed
call    8 never executed
call    9 never executed
call   10 never executed
    #####:  574:        for (const Token *tok = scope->bodyStart; tok != scope->bodyEnd; tok = tok->next()) {
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  575:            if (!Token::Match(tok, "%name% (") || Token::simpleMatch(tok, ") {"))
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
branch  6 never executed
branch  7 never executed
branch  8 never executed
branch  9 never executed
branch 10 never executed
branch 11 never executed
    #####:  576:                continue;
    #####:  577:            if (!mSettings->library.hasminsize(tok))
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
    #####:  578:                continue;
    #####:  579:            const std::vector<const Token *> args = getArguments(tok);
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
call    4 never executed
    #####:  580:            for (int argnr = 0; argnr < args.size(); ++argnr) {
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  581:                if (!args[argnr]->valueType() || args[argnr]->valueType()->pointer == 0)
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
call    5 never executed
branch  6 never executed
branch  7 never executed
branch  8 never executed
branch  9 never executed
    #####:  582:                    continue;
    #####:  583:                const std::vector<Library::ArgumentChecks::MinSize> *minsizes = mSettings->library.argminsizes(tok, argnr + 1);
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  584:                if (!minsizes || minsizes->empty())
branch  0 never executed
branch  1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
    #####:  585:                    continue;
        -:  586:                // Get buffer size..
    #####:  587:                const Token *argtok = args[argnr];
call    0 never executed
    #####:  588:                while (argtok && argtok->isCast())
branch  0 never executed
branch  1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
branch  8 never executed
    #####:  589:                    argtok = argtok->astOperand2() ? argtok->astOperand2() : argtok->astOperand1();
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
call    4 never executed
    #####:  590:                while (Token::Match(argtok, ".|::"))
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
    #####:  591:                    argtok = argtok->astOperand2();
call    0 never executed
    #####:  592:                if (!argtok || !argtok->variable())
branch  0 never executed
branch  1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
    #####:  593:                    continue;
        -:  594:                // TODO: strcpy(buf+10, "hello");
    #####:  595:                const ValueFlow::Value bufferSize = getBufferSize(argtok);
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  596:                if (bufferSize.intvalue <= 1)
branch  0 never executed
branch  1 never executed
    #####:  597:                    continue;
function _ZZN18CheckBufferOverrun14bufferOverflowEvENUlRKN7Library14ArgumentChecks7MinSizeEE_C2ERKS5_ called 0 returned 0% blocks executed 0%
function _ZZN18CheckBufferOverrun14bufferOverflowEvENUlRKN7Library14ArgumentChecks7MinSizeEE_C2EOS5_ called 0 returned 0% blocks executed 0%
function _ZZN18CheckBufferOverrun14bufferOverflowEvENUlRKN7Library14ArgumentChecks7MinSizeEE_D2Ev called 0 returned 0% blocks executed 0%
function _ZZN18CheckBufferOverrun14bufferOverflowEvENKUlRKN7Library14ArgumentChecks7MinSizeEE_clES4_ called 0 returned 0% blocks executed 0%
    #####:  598:                bool error = std::none_of(minsizes->begin(), minsizes->end(), [=](const Library::ArgumentChecks::MinSize &minsize) {
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
call    5 never executed
branch  6 never executed
branch  7 never executed
call    8 never executed
branch  9 never executed
branch 10 never executed
call   11 never executed
call   12 never executed
call   13 never executed
call   14 never executed
call   15 never executed
call   16 never executed
call   17 never executed
call   18 never executed
call   19 never executed
call   20 never executed
branch 21 never executed
branch 22 never executed
call   23 never executed
call   24 never executed
call   25 never executed
    #####:  599:                    return checkBufferSize(tok, minsize, args, bufferSize.intvalue, mSettings);
    #####:  600:                });
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  601:                if (error)
branch  0 never executed
branch  1 never executed
    #####:  602:                    bufferOverflowError(args[argnr], &bufferSize);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
branch  5 never executed
branch  6 never executed
        -:  603:            }
        -:  604:        }
        -:  605:    }
    #####:  606:}
        -:  607:
function _ZN18CheckBufferOverrun19bufferOverflowErrorEPK5TokenPKN9ValueFlow5ValueE called 0 returned 0% blocks executed 0%
    #####:  608:void CheckBufferOverrun::bufferOverflowError(const Token *tok, const ValueFlow::Value *value)
        -:  609:{
    #####:  610:    reportError(getErrorPath(tok, value, "Buffer overrun"), Severity::error, "bufferAccessOutOfBounds", "Buffer is accessed out of bounds: " + (tok ? tok->expressionString() : "buf"), CWE_BUFFER_OVERRUN, false);
branch  0 never executed
branch  1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
call    9 never executed
branch 10 never executed
branch 11 never executed
call   12 never executed
call   13 never executed
branch 14 never executed
branch 15 never executed
call   16 never executed
branch 17 never executed
branch 18 never executed
call   19 never executed
branch 20 never executed
branch 21 never executed
call   22 never executed
call   23 never executed
call   24 never executed
call   25 never executed
call   26 never executed
branch 27 never executed
branch 28 never executed
call   29 never executed
call   30 never executed
call   31 never executed
call   32 never executed
call   33 never executed
call   34 never executed
branch 35 never executed
branch 36 never executed
call   37 never executed
    #####:  611:}
        -:  612:
        -:  613://---------------------------------------------------------------------------
        -:  614:
function _ZN18CheckBufferOverrun19arrayIndexThenCheckEv called 0 returned 0% blocks executed 0%
    #####:  615:void CheckBufferOverrun::arrayIndexThenCheck()
        -:  616:{
    #####:  617:    if (!mSettings->isEnabled(Settings::PORTABILITY))
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  618:        return;
        -:  619:
    #####:  620:    const SymbolDatabase *symbolDatabase = mTokenizer->getSymbolDatabase();
call    0 never executed
    #####:  621:    for (const Scope * const scope : symbolDatabase->functionScopes) {
call    0 never executed
call    1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
call    6 never executed
call    7 never executed
call    8 never executed
call    9 never executed
call   10 never executed
    #####:  622:        for (const Token *tok = scope->bodyStart; tok && tok != scope->bodyEnd; tok = tok->next()) {
branch  0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
    #####:  623:            if (Token::simpleMatch(tok, "sizeof (")) {
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
    #####:  624:                tok = tok->linkAt(1);
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  625:                continue;
        -:  626:            }
        -:  627:
    #####:  628:            if (Token::Match(tok, "%name% [ %var% ]")) {
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
    #####:  629:                tok = tok->next();
call    0 never executed
        -:  630:
    #####:  631:                const int indexID = tok->next()->varId();
call    0 never executed
call    1 never executed
    #####:  632:                const std::string& indexName(tok->strAt(1));
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:  633:
        -:  634:                // Iterate AST upwards
    #####:  635:                const Token* tok2 = tok;
    #####:  636:                const Token* tok3 = tok2;
    #####:  637:                while (tok2->astParent() && tok2->tokType() != Token::eLogicalOp) {
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
    #####:  638:                    tok3 = tok2;
    #####:  639:                    tok2 = tok2->astParent();
call    0 never executed
        -:  640:                }
        -:  641:
        -:  642:                // Ensure that we ended at a logical operator and that we came from its left side
    #####:  643:                if (tok2->tokType() != Token::eLogicalOp || tok2->astOperand1() != tok3)
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
    #####:  644:                    continue;
        -:  645:
        -:  646:                // check if array index is ok
        -:  647:                // statement can be closed in parentheses, so "(| " is using
    #####:  648:                if (Token::Match(tok2, "&& (| %varid% <|<=", indexID))
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
    #####:  649:                    arrayIndexThenCheckError(tok, indexName);
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  650:                else if (Token::Match(tok2, "&& (| %any% >|>= %varid% !!+", indexID))
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
    #####:  651:                    arrayIndexThenCheckError(tok, indexName);
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:  652:            }
        -:  653:        }
        -:  654:    }
        -:  655:}
        -:  656:
function _ZN18CheckBufferOverrun24arrayIndexThenCheckErrorEPK5TokenRKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE called 0 returned 0% blocks executed 0%
    #####:  657:void CheckBufferOverrun::arrayIndexThenCheckError(const Token *tok, const std::string &indexName)
        -:  658:{
    #####:  659:    reportError(tok, Severity::style, "arrayIndexThenCheck",
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  660:                "$symbol:" + indexName + "\n"
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
call    5 never executed
call    6 never executed
call    7 never executed
        -:  661:                "Array index '$symbol' is used before limits check.\n"
        -:  662:                "Defensive programming: The variable '$symbol' is used as an array index before it "
        -:  663:                "is checked that is within limits. This can mean that the array might be accessed out of bounds. "
        -:  664:                "Reorder conditions such as '(a[i] && i < 10)' to '(i < 10 && a[i])'. That way the array will "
        -:  665:                "not be accessed if the index is out of limits.", CWE_ARRAY_INDEX_THEN_CHECK, false);
    #####:  666:}
        -:  667:
        -:  668://---------------------------------------------------------------------------
        -:  669:
function _ZN18CheckBufferOverrun23stringNotZeroTerminatedEv called 0 returned 0% blocks executed 0%
    #####:  670:void CheckBufferOverrun::stringNotZeroTerminated()
        -:  671:{
        -:  672:    // this is currently 'inconclusive'. See TestBufferOverrun::terminateStrncpy3
    #####:  673:    if (!mSettings->isEnabled(Settings::WARNING) || !mSettings->inconclusive)
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
    #####:  674:        return;
    #####:  675:    const SymbolDatabase *symbolDatabase = mTokenizer->getSymbolDatabase();
call    0 never executed
    #####:  676:    for (const Scope * const scope : symbolDatabase->functionScopes) {
call    0 never executed
call    1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
call    6 never executed
call    7 never executed
call    8 never executed
call    9 never executed
call   10 never executed
    #####:  677:        for (const Token *tok = scope->bodyStart; tok && tok != scope->bodyEnd; tok = tok->next()) {
branch  0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
    #####:  678:            if (!Token::simpleMatch(tok, "strncpy ("))
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
    #####:  679:                continue;
    #####:  680:            const std::vector<const Token *> args = getArguments(tok);
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  681:            if (args.size() != 3)
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  682:                continue;
    #####:  683:            const Token *sizeToken = args[2];
call    0 never executed
    #####:  684:            if (!sizeToken->hasKnownIntValue())
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
    #####:  685:                continue;
    #####:  686:            const ValueFlow::Value &bufferSize = getBufferSize(args[0]);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
branch  5 never executed
branch  6 never executed
call    7 never executed
    #####:  687:            if (bufferSize.intvalue < 0 || sizeToken->getKnownIntValue() < bufferSize.intvalue)
branch  0 never executed
branch  1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
    #####:  688:                continue;
    #####:  689:            const Token *srcValue = args[1]->getValueTokenMaxStrLength();
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
    #####:  690:            if (srcValue && Token::getStrLength(srcValue) < sizeToken->getKnownIntValue())
branch  0 never executed
branch  1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
branch  6 never executed
branch  7 never executed
branch  8 never executed
branch  9 never executed
    #####:  691:                continue;
        -:  692:            // Is the buffer zero terminated after the call?
    #####:  693:            bool isZeroTerminated = false;
    #####:  694:            for (const Token *tok2 = tok->next()->link(); tok2 != scope->bodyEnd; tok2 = tok2->next()) {
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
    #####:  695:                if (!Token::simpleMatch(tok2, "] ="))
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
    #####:  696:                    continue;
    #####:  697:                const Token *rhs = tok2->next()->astOperand2();
call    0 never executed
call    1 never executed
    #####:  698:                if (!rhs || !rhs->hasKnownIntValue() || rhs->getKnownIntValue() != 0)
branch  0 never executed
branch  1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
call    7 never executed
branch  8 never executed
branch  9 never executed
branch 10 never executed
branch 11 never executed
    #####:  699:                    continue;
    #####:  700:                if (isSameExpression(mTokenizer->isCPP(), false, args[0], tok2->link()->astOperand1(), mSettings->library, false, false))
call    0 never executed
call    1 never executed
call    2 never executed
call    3 never executed
call    4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
branch  8 never executed
    #####:  701:                    isZeroTerminated = true;
        -:  702:            }
    #####:  703:            if (isZeroTerminated)
branch  0 never executed
branch  1 never executed
    #####:  704:                continue;
        -:  705:            // TODO: Locate unsafe string usage..
    #####:  706:            terminateStrncpyError(tok, args[0]->expressionString());
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
branch  5 never executed
branch  6 never executed
call    7 never executed
call    8 never executed
branch  9 never executed
branch 10 never executed
call   11 never executed
        -:  707:        }
        -:  708:    }
        -:  709:}
        -:  710:
function _ZN18CheckBufferOverrun21terminateStrncpyErrorEPK5TokenRKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE called 0 returned 0% blocks executed 0%
    #####:  711:void CheckBufferOverrun::terminateStrncpyError(const Token *tok, const std::string &varname)
        -:  712:{
    #####:  713:    const std::string shortMessage = "The buffer '$symbol' may not be null-terminated after the call to strncpy().";
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
call    5 never executed
call    6 never executed
    #####:  714:    reportError(tok, Severity::warning, "terminateStrncpy",
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  715:                "$symbol:" + varname + '\n' +
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
call    9 never executed
call   10 never executed
call   11 never executed
call   12 never executed
call   13 never executed
call   14 never executed
    #####:  716:                shortMessage + '\n' +
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
call    7 never executed
call    8 never executed
call    9 never executed
    #####:  717:                shortMessage + ' ' +
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
call    7 never executed
call    8 never executed
call    9 never executed
        -:  718:                "If the source string's size fits or exceeds the given size, strncpy() does not add a "
        -:  719:                "zero at the end of the buffer. This causes bugs later in the code if the code "
        -:  720:                "assumes buffer is null-terminated.", CWE170, true);
    #####:  721:}
call    0 never executed
        -:  722:
function _ZN18CheckBufferOverrun28bufferNotZeroTerminatedErrorEPK5TokenRKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEESA_ called 0 returned 0% blocks executed 0%
    #####:  723:void CheckBufferOverrun::bufferNotZeroTerminatedError(const Token *tok, const std::string &varname, const std::string &function)
        -:  724:{
    #####:  725:    const std::string errmsg = "$symbol:" + varname + '\n' +
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
call    9 never executed
call   10 never executed
call   11 never executed
call   12 never executed
    #####:  726:                               "$symbol:" + function + '\n' +
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
call    9 never executed
call   10 never executed
call   11 never executed
call   12 never executed
call   13 never executed
call   14 never executed
    #####:  727:                               "The buffer '" + varname + "' is not null-terminated after the call to " + function + "().\n"
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
call    9 never executed
branch 10 never executed
branch 11 never executed
call   12 never executed
call   13 never executed
call   14 never executed
call   15 never executed
call   16 never executed
call   17 never executed
call   18 never executed
call   19 never executed
    #####:  728:                               "The buffer '" + varname + "' is not null-terminated after the call to " + function + "(). "
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
call    9 never executed
call   10 never executed
call   11 never executed
call   12 never executed
call   13 never executed
call   14 never executed
    #####:  729:                               "This will cause bugs later in the code if the code assumes the buffer is null-terminated.";
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
call    4 never executed
call    5 never executed
        -:  730:
    #####:  731:    reportError(tok, Severity::warning, "bufferNotZeroTerminated", errmsg, CWE170, true);
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
call    7 never executed
    #####:  732:}
call    0 never executed
        -:  733:
        -:  734:
        -:  735:
        -:  736://---------------------------------------------------------------------------
        -:  737:// CTU..
        -:  738://---------------------------------------------------------------------------
        -:  739:
function _ZNK18CheckBufferOverrun10MyFileInfo8toStringB5cxx11Ev called 0 returned 0% blocks executed 0%
    #####:  740:std::string CheckBufferOverrun::MyFileInfo::toString() const
        -:  741:{
    #####:  742:    std::string xml;
call    0 never executed
    #####:  743:    if (!unsafeArrayIndex.empty())
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  744:        xml = "    <array-index>\n" + CTU::toString(unsafeArrayIndex) + "    </array-index>\n";
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
call    9 never executed
call   10 never executed
call   11 never executed
call   12 never executed
call   13 never executed
call   14 never executed
    #####:  745:    if (!unsafePointerArith.empty())
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  746:        xml += "    <pointer-arith>\n" + CTU::toString(unsafePointerArith) + "    </pointer-arith>\n";
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
call    9 never executed
branch 10 never executed
branch 11 never executed
call   12 never executed
call   13 never executed
call   14 never executed
call   15 never executed
call   16 never executed
call   17 never executed
call   18 never executed
    #####:  747:    return xml;
        -:  748:}
        -:  749:
function _ZN18CheckBufferOverrun22isCtuUnsafeBufferUsageEPK5CheckPK5TokenPxi called 0 returned 0% blocks executed 0%
    #####:  750:bool CheckBufferOverrun::isCtuUnsafeBufferUsage(const Check *check, const Token *argtok, MathLib::bigint *offset, int type)
        -:  751:{
    #####:  752:    const CheckBufferOverrun *c = dynamic_cast<const CheckBufferOverrun *>(check);
branch  0 never executed
branch  1 never executed
    #####:  753:    if (!c)
branch  0 never executed
branch  1 never executed
    #####:  754:        return false;
    #####:  755:    if (!argtok->valueType() || argtok->valueType()->typeSize(*c->mSettings) == 0)
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
call    4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
branch  8 never executed
    #####:  756:        return false;
    #####:  757:    const Token *indexTok = nullptr;
    #####:  758:    if (type == 1 && Token::Match(argtok, "%name% [") && argtok->astParent() == argtok->next() && !Token::simpleMatch(argtok->linkAt(1), "] ["))
branch  0 never executed
branch  1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
call    9 never executed
call   10 never executed
branch 11 never executed
branch 12 never executed
branch 13 never executed
branch 14 never executed
    #####:  759:        indexTok = argtok->next()->astOperand2();
call    0 never executed
call    1 never executed
    #####:  760:    else if (type == 2 && Token::simpleMatch(argtok->astParent(), "+"))
branch  0 never executed
branch  1 never executed
call    2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
    #####:  761:        indexTok = (argtok == argtok->astParent()->astOperand1()) ?
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
call    5 never executed
    #####:  762:                   argtok->astParent()->astOperand2() :
call    0 never executed
    #####:  763:                   argtok->astParent()->astOperand1();
call    0 never executed
    #####:  764:    if (!indexTok)
branch  0 never executed
branch  1 never executed
    #####:  765:        return false;
    #####:  766:    if (!indexTok->hasKnownIntValue())
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  767:        return false;
    #####:  768:    if (!offset)
branch  0 never executed
branch  1 never executed
    #####:  769:        return false;
    #####:  770:    *offset = indexTok->getKnownIntValue() * argtok->valueType()->typeSize(*c->mSettings);
call    0 never executed
call    1 never executed
call    2 never executed
    #####:  771:    return true;
        -:  772:}
        -:  773:
function _ZN18CheckBufferOverrun21isCtuUnsafeArrayIndexEPK5CheckPK5TokenPx called 0 returned 0% blocks executed 0%
    #####:  774:bool CheckBufferOverrun::isCtuUnsafeArrayIndex(const Check *check, const Token *argtok, MathLib::bigint *offset)
        -:  775:{
    #####:  776:    return CheckBufferOverrun::isCtuUnsafeBufferUsage(check, argtok, offset, 1);
call    0 never executed
        -:  777:}
        -:  778:
function _ZN18CheckBufferOverrun23isCtuUnsafePointerArithEPK5CheckPK5TokenPx called 0 returned 0% blocks executed 0%
    #####:  779:bool CheckBufferOverrun::isCtuUnsafePointerArith(const Check *check, const Token *argtok, MathLib::bigint *offset)
        -:  780:{
    #####:  781:    return CheckBufferOverrun::isCtuUnsafeBufferUsage(check, argtok, offset, 2);
call    0 never executed
        -:  782:}
        -:  783:
        -:  784:/** @brief Parse current TU and extract file info */
function _ZNK18CheckBufferOverrun11getFileInfoEPK9TokenizerPK8Settings called 0 returned 0% blocks executed 0%
    #####:  785:Check::FileInfo *CheckBufferOverrun::getFileInfo(const Tokenizer *tokenizer, const Settings *settings) const
        -:  786:{
    #####:  787:    CheckBufferOverrun checkBufferOverrun(tokenizer, settings, nullptr);
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
call    4 never executed
    #####:  788:    MyFileInfo *fileInfo = new MyFileInfo;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  789:    fileInfo->unsafeArrayIndex = CTU::getUnsafeUsage(tokenizer, settings, &checkBufferOverrun, isCtuUnsafeArrayIndex);
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
call    4 never executed
    #####:  790:    fileInfo->unsafePointerArith = CTU::getUnsafeUsage(tokenizer, settings, &checkBufferOverrun, isCtuUnsafePointerArith);
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
call    4 never executed
    #####:  791:    if (fileInfo->unsafeArrayIndex.empty() && fileInfo->unsafePointerArith.empty()) {
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
    #####:  792:        delete fileInfo;
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  793:        return nullptr;
        -:  794:    }
    #####:  795:    return fileInfo;
        -:  796:}
        -:  797:
function _ZNK18CheckBufferOverrun19loadFileInfoFromXmlEPKN8tinyxml210XMLElementE called 0 returned 0% blocks executed 0%
    #####:  798:Check::FileInfo * CheckBufferOverrun::loadFileInfoFromXml(const tinyxml2::XMLElement *xmlElement) const
        -:  799:{
    #####:  800:    const std::string arrayIndex("array-index");
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
call    5 never executed
call    6 never executed
call    7 never executed
call    8 never executed
    #####:  801:    const std::string pointerArith("pointer-arith");
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
call    5 never executed
call    6 never executed
        -:  802:
    #####:  803:    MyFileInfo *fileInfo = new MyFileInfo;
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  804:    for (const tinyxml2::XMLElement *e = xmlElement->FirstChildElement(); e; e = e->NextSiblingElement()) {
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
branch  6 never executed
branch  7 never executed
    #####:  805:        if (e->Name() == arrayIndex)
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
    #####:  806:            fileInfo->unsafeArrayIndex = CTU::loadUnsafeUsageListFromXml(e);
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
call    4 never executed
    #####:  807:        else if (e->Name() == pointerArith)
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
    #####:  808:            fileInfo->unsafePointerArith = CTU::loadUnsafeUsageListFromXml(e);
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
call    4 never executed
        -:  809:    }
        -:  810:
    #####:  811:    if (fileInfo->unsafeArrayIndex.empty() && fileInfo->unsafePointerArith.empty()) {
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
branch  6 never executed
branch  7 never executed
    #####:  812:        delete fileInfo;
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  813:        return nullptr;
        -:  814:    }
        -:  815:
    #####:  816:    return fileInfo;
        -:  817:}
        -:  818:
        -:  819:/** @brief Analyse all file infos for all TU */
function _ZN18CheckBufferOverrun19analyseWholeProgramEPKN3CTU8FileInfoERKNSt7__debug4listIPN5Check8FileInfoESaIS8_EEERK8SettingsR11ErrorLogger called 0 returned 0% blocks executed 0%
    #####:  820:bool CheckBufferOverrun::analyseWholeProgram(const CTU::FileInfo *ctu, const std::list<Check::FileInfo*> &fileInfo, const Settings& settings, ErrorLogger &errorLogger)
        -:  821:{
    #####:  822:    if (!ctu)
branch  0 never executed
branch  1 never executed
    #####:  823:        return false;
    #####:  824:    bool foundErrors = false;
        -:  825:    (void)settings; // This argument is unused
        -:  826:
    #####:  827:    const std::map<std::string, std::list<const CTU::FileInfo::CallBase *>> callsMap = ctu->getCallsMap();
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
call    4 never executed
        -:  828:
    #####:  829:    for (Check::FileInfo *fi1 : fileInfo) {
call    0 never executed
call    1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
call    6 never executed
call    7 never executed
call    8 never executed
call    9 never executed
call   10 never executed
    #####:  830:        const MyFileInfo *fi = dynamic_cast<MyFileInfo*>(fi1);
branch  0 never executed
branch  1 never executed
    #####:  831:        if (!fi)
branch  0 never executed
branch  1 never executed
    #####:  832:            continue;
    #####:  833:        for (const CTU::FileInfo::UnsafeUsage &unsafeUsage : fi->unsafeArrayIndex)
call    0 never executed
call    1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
call    6 never executed
call    7 never executed
call    8 never executed
call    9 never executed
call   10 never executed
    #####:  834:            foundErrors |= analyseWholeProgram1(ctu, callsMap, unsafeUsage, 1, errorLogger);
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  835:        for (const CTU::FileInfo::UnsafeUsage &unsafeUsage : fi->unsafePointerArith)
call    0 never executed
call    1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
call    6 never executed
call    7 never executed
call    8 never executed
call    9 never executed
call   10 never executed
    #####:  836:            foundErrors |= analyseWholeProgram1(ctu, callsMap, unsafeUsage, 2, errorLogger);
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:  837:    }
    #####:  838:    return foundErrors;
        -:  839:}
        -:  840:
function _ZN18CheckBufferOverrun20analyseWholeProgram1EPKN3CTU8FileInfoERKNSt7__debug3mapINSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEENS4_4listIPKNS1_8CallBaseESaISF_EEESt4lessISB_ESaISt4pairIKSB_SH_EEEERKNS1_11UnsafeUsageEiR11ErrorLogger called 0 returned 0% blocks executed 0%
    #####:  841:bool CheckBufferOverrun::analyseWholeProgram1(const CTU::FileInfo *ctu, const std::map<std::string, std::list<const CTU::FileInfo::CallBase *>> &callsMap, const CTU::FileInfo::UnsafeUsage &unsafeUsage, int type, ErrorLogger &errorLogger)
        -:  842:{
    #####:  843:    const CTU::FileInfo::FunctionCall *functionCall = nullptr;
        -:  844:
        -:  845:    const std::list<ErrorLogger::ErrorMessage::FileLocation> &locationList =
        -:  846:        ctu->getErrorPath(CTU::FileInfo::InvalidValueType::bufferOverflow,
        -:  847:                          unsafeUsage,
        -:  848:                          callsMap,
        -:  849:                          "Using argument ARG",
        -:  850:                          &functionCall,
    #####:  851:                          false);
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
call    4 never executed
    #####:  852:    if (locationList.empty())
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  853:        return false;
        -:  854:
    #####:  855:    const char *errorId = nullptr;
    #####:  856:    std::string errmsg;
call    0 never executed
call    1 never executed
call    2 never executed
    #####:  857:    CWE cwe(0);
call    0 never executed
        -:  858:
    #####:  859:    if (type == 1) {
branch  0 never executed
branch  1 never executed
    #####:  860:        errorId = "ctuArrayIndex";
    #####:  861:        if (unsafeUsage.value > 0)
branch  0 never executed
branch  1 never executed
    #####:  862:            errmsg = "Array index out of bounds; '" + unsafeUsage.myArgumentName + "' buffer size is " + MathLib::toString(functionCall->callArgValue) + " and it is accessed at offset " + MathLib::toString(unsafeUsage.value) + ".";
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
call    9 never executed
branch 10 never executed
branch 11 never executed
call   12 never executed
branch 13 never executed
branch 14 never executed
call   15 never executed
branch 16 never executed
branch 17 never executed
call   18 never executed
branch 19 never executed
branch 20 never executed
call   21 never executed
branch 22 never executed
branch 23 never executed
call   24 never executed
call   25 never executed
call   26 never executed
call   27 never executed
call   28 never executed
call   29 never executed
call   30 never executed
call   31 never executed
call   32 never executed
call   33 never executed
call   34 never executed
call   35 never executed
call   36 never executed
call   37 never executed
call   38 never executed
call   39 never executed
        -:  863:        else
    #####:  864:            errmsg = "Array index out of bounds; buffer '" + unsafeUsage.myArgumentName + "' is accessed at offset " + MathLib::toString(unsafeUsage.value) + ".";
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
call    9 never executed
branch 10 never executed
branch 11 never executed
call   12 never executed
branch 13 never executed
branch 14 never executed
call   15 never executed
call   16 never executed
call   17 never executed
call   18 never executed
call   19 never executed
call   20 never executed
call   21 never executed
call   22 never executed
call   23 never executed
call   24 never executed
    #####:  865:        cwe = (unsafeUsage.value > 0) ? CWE_BUFFER_OVERRUN : CWE_BUFFER_UNDERRUN;
branch  0 never executed
branch  1 never executed
        -:  866:    } else {
    #####:  867:        errorId = "ctuPointerArith";
    #####:  868:        errmsg = "Pointer arithmetic overflow; '" + unsafeUsage.myArgumentName + "' buffer size is " + MathLib::toString(functionCall->callArgValue);
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
call    9 never executed
branch 10 never executed
branch 11 never executed
call   12 never executed
call   13 never executed
call   14 never executed
call   15 never executed
call   16 never executed
call   17 never executed
call   18 never executed
call   19 never executed
call   20 never executed
    #####:  869:        cwe = CWE_POINTER_ARITHMETIC_OVERFLOW;
        -:  870:    }
        -:  871:
        -:  872:    const ErrorLogger::ErrorMessage errorMessage(locationList,
        -:  873:            emptyString,
        -:  874:            Severity::error,
        -:  875:            errmsg,
        -:  876:            errorId,
    #####:  877:            cwe, false);
call    0 never executed
call    1 never executed
branch  2 never executed
branch  3 never executed
call    4 never executed
branch  5 never executed
branch  6 never executed
call    7 never executed
call    8 never executed
call    9 never executed
call   10 never executed
call   11 never executed
    #####:  878:    errorLogger.reportErr(errorMessage);
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:  879:
    #####:  880:    return true;
        -:  881:}
        -:  882:
function _ZN18CheckBufferOverrun11objectIndexEv called 0 returned 0% blocks executed 0%
    #####:  883:void CheckBufferOverrun::objectIndex()
        -:  884:{
    #####:  885:    const SymbolDatabase *symbolDatabase = mTokenizer->getSymbolDatabase();
call    0 never executed
    #####:  886:    for (const Scope *functionScope : symbolDatabase->functionScopes) {
call    0 never executed
call    1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
call    6 never executed
call    7 never executed
call    8 never executed
call    9 never executed
call   10 never executed
    #####:  887:        for (const Token *tok = functionScope->bodyStart; tok != functionScope->bodyEnd; tok = tok->next()) {
branch  0 never executed
branch  1 never executed
call    2 never executed
    #####:  888:            if (!Token::simpleMatch(tok, "["))
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
    #####:  889:                continue;
    #####:  890:            const Token *obj = tok->astOperand1();
call    0 never executed
    #####:  891:            const Token *idx = tok->astOperand2();
call    0 never executed
    #####:  892:            if (!idx || !obj)
branch  0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
    #####:  893:                continue;
    #####:  894:            if (idx->hasKnownIntValue() && idx->getKnownIntValue() == 0)
call    0 never executed
branch  1 never executed
branch  2 never executed
branch  3 never executed
branch  4 never executed
call    5 never executed
branch  6 never executed
branch  7 never executed
branch  8 never executed
branch  9 never executed
    #####:  895:                continue;
        -:  896:
    #####:  897:            ValueFlow::Value v = getLifetimeObjValue(obj);
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
    #####:  898:            if (!v.isLocalLifetimeValue())
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  899:                continue;
    #####:  900:            if (v.lifetimeKind != ValueFlow::Value::LifetimeKind::Address)
branch  0 never executed
branch  1 never executed
    #####:  901:                continue;
    #####:  902:            const Variable *var = v.tokvalue->variable();
call    0 never executed
    #####:  903:            if (var->isReference())
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  904:                continue;
    #####:  905:            if (var->isRValueReference())
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  906:                continue;
    #####:  907:            if (var->isArray())
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  908:                continue;
    #####:  909:            if (var->isPointer())
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  910:                continue;
    #####:  911:            objectIndexError(tok, &v, idx->hasKnownIntValue());
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
        -:  912:        }
        -:  913:    }
    #####:  914:}
        -:  915:
function _ZN18CheckBufferOverrun16objectIndexErrorEPK5TokenPKN9ValueFlow5ValueEb called 0 returned 0% blocks executed 0%
    #####:  916:void CheckBufferOverrun::objectIndexError(const Token *tok, const ValueFlow::Value *v, bool known)
        -:  917:{
    #####:  918:    ErrorPath errorPath;
call    0 never executed
call    1 never executed
call    2 never executed
    #####:  919:    std::string name;
call    0 never executed
call    1 never executed
call    2 never executed
    #####:  920:    if (v) {
branch  0 never executed
branch  1 never executed
    #####:  921:        name = v->tokvalue->variable()->name();
call    0 never executed
call    1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
    #####:  922:        errorPath = v->errorPath;
call    0 never executed
branch  1 never executed
branch  2 never executed
        -:  923:    }
    #####:  924:    errorPath.emplace_back(tok, "");
call    0 never executed
branch  1 never executed
branch  2 never executed
    #####:  925:    std::string verb = known ? "is" : "might be";
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
call    7 never executed
call    8 never executed
    #####:  926:    reportError(errorPath,
branch  0 never executed
branch  1 never executed
call    2 never executed
branch  3 never executed
branch  4 never executed
        -:  927:                known ? Severity::error : Severity::warning,
        -:  928:                "objectIndex",
    #####:  929:                "The address of local variable '" + name + "' " + verb + " accessed at non-zero index.",
call    0 never executed
branch  1 never executed
branch  2 never executed
call    3 never executed
branch  4 never executed
branch  5 never executed
call    6 never executed
branch  7 never executed
branch  8 never executed
call    9 never executed
branch 10 never executed
branch 11 never executed
call   12 never executed
call   13 never executed
call   14 never executed
call   15 never executed
call   16 never executed
call   17 never executed
call   18 never executed
call   19 never executed
        -:  930:                CWE758,
        -:  931:                false);
function _GLOBAL__sub_I__ZN18CheckBufferOverrun10arrayIndexEv called 1 returned 100% blocks executed 100%
function _Z41__static_initialization_and_destruction_0ii called 1 returned 100% blocks executed 100%
        3:  932:}
call    0 returned 100%
branch  1 taken 100% (fallthrough)
branch  2 taken 0%
branch  3 taken 100% (fallthrough)
branch  4 taken 0%
call    5 never executed
